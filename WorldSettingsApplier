package com.crafterscr.Multiverso.util;

import com.crafterscr.Multiverso.config.WorldConfig;
import com.crafterscr.Multiverso.config.WorldConfigLoader;
import com.crafterscr.Multiverso.config.WorldConfigManager;
import net.minecraft.server.MinecraftServer;
import net.minecraft.server.level.ServerLevel;
import net.minecraft.world.Difficulty;
import net.minecraft.world.level.GameRules;

public class WorldSettingsApplier {

    public static void applySettings(MinecraftServer server, String worldName, WorldConfig config) {
        ServerLevel level = server.getLevel(WorldConfig.getDimensionKey(worldName));
        if (level == null) return;

        // Aplicar dificultad
        switch (config.difficulty.toLowerCase()) {
            case "peaceful" -> level.setDifficulty(Difficulty.PEACEFUL, true);
            case "easy" -> level.setDifficulty(Difficulty.EASY, true);
            case "normal" -> level.setDifficulty(Difficulty.NORMAL, true);
            case "hard" -> level.setDifficulty(Difficulty.HARD, true);
        }

        // Spawneo de mobs hostiles
        level.getGameRules().getRule(GameRules.RULE_DOMOBSPAWNING).set(config.allowMonsters, server);
        level.setSpawnSettings(config.allowMonsters, config.allowAnimals);

        // Aplicar posición de spawn si se configuró
        level.setDefaultSpawnPos(
                new net.minecraft.core.BlockPos(config.spawnX, config.spawnY, config.spawnZ),
                0.0F
        );
    }
}
